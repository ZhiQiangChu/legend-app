2017-10-17 10:07:56.106 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Neither @ContextConfiguration nor @ContextHierarchy found for test class [AppTest], using SpringBootContextLoader
2017-10-17 10:07:56.131 [main] INFO  o.s.t.c.s.AbstractContextLoader -Could not detect default resource locations for test class [AppTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2017-10-17 10:07:56.401 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@909217e, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@18271936, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@606e4010, org.springframework.test.context.support.DirtiesContextTestExecutionListener@8458f04]
2017-10-17 10:07:58.081 [main] INFO  AppTest -Starting AppTest on sondon with PID 8374 (started by sondon in /home/sondon/IdeaProjects/dplus-service/legend-app)
2017-10-17 10:07:58.082 [main] INFO  AppTest -The following profiles are active: local
2017-10-17 10:08:00.902 [main] WARN  o.m.s.mapper.ClassPathMapperScanner -No MyBatis mapper was found in '[cn.com.dplus.legend.application]' package. Please check your configuration.
2017-10-17 10:08:00.957 [main] INFO  o.s.b.f.s.DefaultListableBeanFactory -Overriding bean definition for bean 'characterEncodingFilter' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=webConfig; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cn/com/dplus/project/config/WebConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/web/HttpEncodingAutoConfiguration.class]]
2017-10-17 10:08:08.418 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
2017-10-17 10:08:08.492 [cluster-ClusterId{value='59e566089d8dab20b654dc43', description='null'}-localhost:27017] INFO  org.mongodb.driver.cluster -Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63)
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115)
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:116)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50)
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58)
	... 3 common frames omitted
2017-10-17 10:08:10.107 [main] INFO  r.clients.jedis.JedisSentinelPool -Trying to find master from available Sentinels...
2017-10-17 10:08:10.153 [main] INFO  r.clients.jedis.JedisSentinelPool -Redis master running at 10.3.2.23:6379, starting Sentinel listeners...
2017-10-17 10:08:10.190 [main] INFO  r.clients.jedis.JedisSentinelPool -Created JedisPool to master at 10.3.2.23:6379
2017-10-17 10:08:10.198 [main] INFO  ROOT -
env--->ZK_LIST
target --->10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:08:10.745 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:08:10.829 [main] INFO  kafka.utils.VerifiableProperties -Property auto.commit.interval.ms is overridden to 1000
2017-10-17 10:08:10.829 [main] INFO  kafka.utils.VerifiableProperties -Property auto.offset.reset is overridden to smallest
2017-10-17 10:08:10.829 [main] INFO  kafka.utils.VerifiableProperties -Property group.id is overridden to legend-app-group
2017-10-17 10:08:10.830 [main] WARN  kafka.utils.VerifiableProperties -Property serializer.class is not valid
2017-10-17 10:08:10.830 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.connect is overridden to 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:08:10.831 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.session.timeout.ms is overridden to 15000
2017-10-17 10:08:10.831 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.sync.time.ms is overridden to 200
2017-10-17 10:08:10.907 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], Connecting to zookeeper instance at 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:08:10.926 [ZkClient-EventThread-27-10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181] INFO  org.I0Itec.zkclient.ZkEventThread -Starting ZkClient event thread.
2017-10-17 10:08:11.011 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Opening socket connection to server 10.3.2.21/10.3.2.21:2181. Will not attempt to authenticate using SASL (unknown error)
2017-10-17 10:08:11.035 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Socket connection established to 10.3.2.21/10.3.2.21:2181, initiating session
2017-10-17 10:08:11.080 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Session establishment complete on server 10.3.2.21/10.3.2.21:2181, sessionid = 0x25f235886b50006, negotiated timeout = 15000
2017-10-17 10:08:11.084 [main-EventThread] INFO  org.I0Itec.zkclient.ZkClient -zookeeper state changed (SyncConnected)
2017-10-17 10:08:11.108 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], starting auto committer every 1000 ms
2017-10-17 10:08:11.180 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], begin registering consumer legend-app-group_sondon-1508206090902-38e64b40 in ZK
2017-10-17 10:08:11.286 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], end registering consumer legend-app-group_sondon-1508206090902-38e64b40 in ZK
2017-10-17 10:08:11.307 [legend-app-group_sondon-1508206090902-38e64b40_watcher_executor] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], starting watcher executor thread for consumer legend-app-group_sondon-1508206090902-38e64b40
2017-10-17 10:08:11.350 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], begin rebalancing consumer legend-app-group_sondon-1508206090902-38e64b40 try #0
2017-10-17 10:08:11.620 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206091096] Stopping leader finder thread
2017-10-17 10:08:11.621 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206091096] Stopping all fetchers
2017-10-17 10:08:11.624 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206091096] All connections stopped
2017-10-17 10:08:11.626 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], Cleared all relevant queues for this fetcher
2017-10-17 10:08:11.630 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], Cleared the data chunks in all the consumer message iterators
2017-10-17 10:08:11.633 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], Committing all offsets after clearing the fetcher queues
2017-10-17 10:08:11.636 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], Releasing partition ownership
2017-10-17 10:08:11.720 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], legend-app-group_sondon-1508206090902-38e64b40-0 successfully owned partition 0 for topic legend-test-topic
2017-10-17 10:08:11.763 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], Consumer legend-app-group_sondon-1508206090902-38e64b40 selected partitions : legend-test-topic:0: fetched offset = 16: consumed offset = 16
2017-10-17 10:08:11.778 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206090902-38e64b40], end rebalancing consumer legend-app-group_sondon-1508206090902-38e64b40 try #0
2017-10-17 10:08:11.786 [main] INFO  ROOT -
env--->KAFKA_LIST
target --->10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:08:11.789 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  k.c.ConsumerFetcherManager$LeaderFinderThread -[legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread], Starting 
2017-10-17 10:08:11.840 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:08:11.841 [main] INFO  kafka.utils.VerifiableProperties -Property key.serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:08:11.841 [main] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:08:11.841 [main] INFO  kafka.utils.VerifiableProperties -Property request.required.acks is overridden to -1
2017-10-17 10:08:11.844 [main] INFO  kafka.utils.VerifiableProperties -Property serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:08:11.875 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:08:11.876 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property client.id is overridden to legend-app-group
2017-10-17 10:08:11.876 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:08:11.876 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property request.timeout.ms is overridden to 30000
2017-10-17 10:08:12.022 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  kafka.client.ClientUtils$ -Fetching metadata from broker id:2,host:10.3.2.22,port:9092 with correlation id 0 for 1 topic(s) Set(legend-test-topic)
2017-10-17 10:08:12.037 [main] INFO  o.m.m.logging.MorphiaLoggerFactory -LoggerImplFactory set to org.mongodb.morphia.logging.jdk.JDKLoggerFactory
2017-10-17 10:08:12.038 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  kafka.producer.SyncProducer -Connected to 10.3.2.22:9092 for producing
2017-10-17 10:08:12.152 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  kafka.producer.SyncProducer -Disconnecting from 10.3.2.22:9092
2017-10-17 10:08:12.213 [legend-app-group_sondon-1508206090902-38e64b40-leader-finder-thread] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206091096] Added fetcher for partitions ArrayBuffer([[legend-test-topic,0], initOffset 16 to broker id:0,host:10.3.2.20,port:9092] )
2017-10-17 10:08:12.218 [ConsumerFetcherThread-legend-app-group_sondon-1508206090902-38e64b40-0-0] INFO  kafka.consumer.ConsumerFetcherThread -[ConsumerFetcherThread-legend-app-group_sondon-1508206090902-38e64b40-0-0], Starting 
2017-10-17 10:08:12.310 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[10.3.2.23:27017, 10.3.2.24:27017, 10.3.2.25:27017], mode=MULTIPLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=40000}
2017-10-17 10:08:12.311 [main] INFO  org.mongodb.driver.cluster -Adding discovered server 10.3.2.23:27017 to client view of cluster
2017-10-17 10:08:12.338 [main] INFO  org.mongodb.driver.cluster -Adding discovered server 10.3.2.24:27017 to client view of cluster
2017-10-17 10:08:12.346 [main] INFO  org.mongodb.driver.cluster -Adding discovered server 10.3.2.25:27017 to client view of cluster
2017-10-17 10:08:12.435 [cluster-ClusterId{value='59e5660c9d8dab20b654dc44', description='null'}-10.3.2.25:27017] INFO  org.mongodb.driver.cluster -Monitor thread successfully connected to server with description ServerDescription{address=10.3.2.25:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, version=ServerVersion{versionList=[3, 2, 9]}, minWireVersion=0, maxWireVersion=4, maxDocumentSize=16777216, roundTripTimeNanos=3704497, setName='sondon', canonicalAddress=10.3.2.25:27017, hosts=[10.3.2.23:27017, 10.3.2.25:27017, 10.3.2.24:27017], passives=[], arbiters=[], primary='10.3.2.23:27017', tagSet=TagSet{[]}, electionId=null, setVersion=1}
2017-10-17 10:08:12.442 [cluster-ClusterId{value='59e5660c9d8dab20b654dc44', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Monitor thread successfully connected to server with description ServerDescription{address=10.3.2.23:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, version=ServerVersion{versionList=[3, 2, 9]}, minWireVersion=0, maxWireVersion=4, maxDocumentSize=16777216, roundTripTimeNanos=10194062, setName='sondon', canonicalAddress=10.3.2.23:27017, hosts=[10.3.2.23:27017, 10.3.2.25:27017, 10.3.2.24:27017], passives=[], arbiters=[], primary='10.3.2.23:27017', tagSet=TagSet{[]}, electionId=7fffffff0000000000000015, setVersion=1}
2017-10-17 10:08:12.442 [cluster-ClusterId{value='59e5660c9d8dab20b654dc44', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Discovered cluster type of REPLICA_SET
2017-10-17 10:08:12.443 [cluster-ClusterId{value='59e5660c9d8dab20b654dc44', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Setting max election id to 7fffffff0000000000000015 from replica set primary 10.3.2.23:27017
2017-10-17 10:08:12.443 [cluster-ClusterId{value='59e5660c9d8dab20b654dc44', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Setting max set version to 1 from replica set primary 10.3.2.23:27017
2017-10-17 10:08:12.443 [cluster-ClusterId{value='59e5660c9d8dab20b654dc44', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Discovered replica set primary 10.3.2.23:27017
2017-10-17 10:08:12.445 [cluster-ClusterId{value='59e5660c9d8dab20b654dc44', description='null'}-10.3.2.24:27017] INFO  org.mongodb.driver.cluster -Monitor thread successfully connected to server with description ServerDescription{address=10.3.2.24:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, version=ServerVersion{versionList=[3, 2, 9]}, minWireVersion=0, maxWireVersion=4, maxDocumentSize=16777216, roundTripTimeNanos=14550185, setName='sondon', canonicalAddress=10.3.2.24:27017, hosts=[10.3.2.23:27017, 10.3.2.25:27017, 10.3.2.24:27017], passives=[], arbiters=[], primary='10.3.2.23:27017', tagSet=TagSet{[]}, electionId=null, setVersion=1}
2017-10-17 10:08:12.673 [main] INFO  ROOT -Application start failed!
2017-10-17 10:09:46.736 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Neither @ContextConfiguration nor @ContextHierarchy found for test class [AppTest], using SpringBootContextLoader
2017-10-17 10:09:46.798 [main] INFO  o.s.t.c.s.AbstractContextLoader -Could not detect default resource locations for test class [AppTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2017-10-17 10:09:46.957 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@8519cb4, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@35dab4eb, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@2d901eb0, org.springframework.test.context.support.DirtiesContextTestExecutionListener@3ba987b8]
2017-10-17 10:09:48.878 [main] INFO  AppTest -Starting AppTest on sondon with PID 8503 (started by sondon in /home/sondon/IdeaProjects/dplus-service/legend-app)
2017-10-17 10:09:48.878 [main] INFO  AppTest -The following profiles are active: local
2017-10-17 10:09:50.812 [main] WARN  o.m.s.mapper.ClassPathMapperScanner -No MyBatis mapper was found in '[cn.com.dplus.legend.application]' package. Please check your configuration.
2017-10-17 10:09:50.875 [main] INFO  o.s.b.f.s.DefaultListableBeanFactory -Overriding bean definition for bean 'characterEncodingFilter' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=webConfig; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cn/com/dplus/project/config/WebConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/web/HttpEncodingAutoConfiguration.class]]
2017-10-17 10:09:56.638 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
2017-10-17 10:09:56.728 [cluster-ClusterId{value='59e566749d8dab2137bae1b5', description='null'}-localhost:27017] INFO  org.mongodb.driver.cluster -Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63)
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115)
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:116)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50)
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58)
	... 3 common frames omitted
2017-10-17 10:09:58.230 [main] INFO  r.clients.jedis.JedisSentinelPool -Trying to find master from available Sentinels...
2017-10-17 10:09:58.263 [main] INFO  r.clients.jedis.JedisSentinelPool -Redis master running at 10.3.2.23:6379, starting Sentinel listeners...
2017-10-17 10:09:58.296 [main] INFO  r.clients.jedis.JedisSentinelPool -Created JedisPool to master at 10.3.2.23:6379
2017-10-17 10:09:58.299 [main] INFO  ROOT -
env--->ZK_LIST
target --->10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:09:58.614 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:09:58.646 [main] INFO  kafka.utils.VerifiableProperties -Property auto.commit.interval.ms is overridden to 1000
2017-10-17 10:09:58.646 [main] INFO  kafka.utils.VerifiableProperties -Property auto.offset.reset is overridden to smallest
2017-10-17 10:09:58.647 [main] INFO  kafka.utils.VerifiableProperties -Property group.id is overridden to legend-app-group
2017-10-17 10:09:58.647 [main] WARN  kafka.utils.VerifiableProperties -Property serializer.class is not valid
2017-10-17 10:09:58.648 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.connect is overridden to 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:09:58.649 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.session.timeout.ms is overridden to 15000
2017-10-17 10:09:58.650 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.sync.time.ms is overridden to 200
2017-10-17 10:09:58.758 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], Connecting to zookeeper instance at 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:09:58.780 [ZkClient-EventThread-27-10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181] INFO  org.I0Itec.zkclient.ZkEventThread -Starting ZkClient event thread.
2017-10-17 10:09:58.832 [main-SendThread(10.3.2.20:2181)] INFO  org.apache.zookeeper.ClientCnxn -Opening socket connection to server 10.3.2.20/10.3.2.20:2181. Will not attempt to authenticate using SASL (unknown error)
2017-10-17 10:09:58.862 [main-SendThread(10.3.2.20:2181)] INFO  org.apache.zookeeper.ClientCnxn -Socket connection established to 10.3.2.20/10.3.2.20:2181, initiating session
2017-10-17 10:09:58.896 [main-SendThread(10.3.2.20:2181)] INFO  org.apache.zookeeper.ClientCnxn -Session establishment complete on server 10.3.2.20/10.3.2.20:2181, sessionid = 0x15f1ab9e1b3000b, negotiated timeout = 15000
2017-10-17 10:09:58.900 [main-EventThread] INFO  org.I0Itec.zkclient.ZkClient -zookeeper state changed (SyncConnected)
2017-10-17 10:09:58.921 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], starting auto committer every 1000 ms
2017-10-17 10:09:58.974 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], begin registering consumer legend-app-group_sondon-1508206198754-1dec10f4 in ZK
2017-10-17 10:09:59.044 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], end registering consumer legend-app-group_sondon-1508206198754-1dec10f4 in ZK
2017-10-17 10:09:59.059 [legend-app-group_sondon-1508206198754-1dec10f4_watcher_executor] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], starting watcher executor thread for consumer legend-app-group_sondon-1508206198754-1dec10f4
2017-10-17 10:09:59.085 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], begin rebalancing consumer legend-app-group_sondon-1508206198754-1dec10f4 try #0
2017-10-17 10:09:59.281 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206198910] Stopping leader finder thread
2017-10-17 10:09:59.283 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206198910] Stopping all fetchers
2017-10-17 10:09:59.285 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206198910] All connections stopped
2017-10-17 10:09:59.287 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], Cleared all relevant queues for this fetcher
2017-10-17 10:09:59.288 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], Cleared the data chunks in all the consumer message iterators
2017-10-17 10:09:59.291 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], Committing all offsets after clearing the fetcher queues
2017-10-17 10:09:59.293 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], Releasing partition ownership
2017-10-17 10:09:59.419 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], legend-app-group_sondon-1508206198754-1dec10f4-0 successfully owned partition 0 for topic legend-test-topic
2017-10-17 10:09:59.452 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], Consumer legend-app-group_sondon-1508206198754-1dec10f4 selected partitions : legend-test-topic:0: fetched offset = 16: consumed offset = 16
2017-10-17 10:09:59.458 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206198754-1dec10f4], end rebalancing consumer legend-app-group_sondon-1508206198754-1dec10f4 try #0
2017-10-17 10:09:59.463 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  k.c.ConsumerFetcherManager$LeaderFinderThread -[legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread], Starting 
2017-10-17 10:09:59.474 [main] INFO  ROOT -
env--->KAFKA_LIST
target --->10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:09:59.537 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:09:59.538 [main] INFO  kafka.utils.VerifiableProperties -Property key.serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:09:59.538 [main] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:09:59.538 [main] INFO  kafka.utils.VerifiableProperties -Property request.required.acks is overridden to -1
2017-10-17 10:09:59.538 [main] INFO  kafka.utils.VerifiableProperties -Property serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:09:59.568 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:09:59.570 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property client.id is overridden to legend-app-group
2017-10-17 10:09:59.573 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:09:59.575 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property request.timeout.ms is overridden to 30000
2017-10-17 10:09:59.626 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  kafka.client.ClientUtils$ -Fetching metadata from broker id:0,host:10.3.2.20,port:9092 with correlation id 0 for 1 topic(s) Set(legend-test-topic)
2017-10-17 10:09:59.630 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  kafka.producer.SyncProducer -Connected to 10.3.2.20:9092 for producing
2017-10-17 10:09:59.635 [main] INFO  o.m.m.logging.MorphiaLoggerFactory -LoggerImplFactory set to org.mongodb.morphia.logging.jdk.JDKLoggerFactory
2017-10-17 10:09:59.669 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  kafka.producer.SyncProducer -Disconnecting from 10.3.2.20:9092
2017-10-17 10:09:59.712 [legend-app-group_sondon-1508206198754-1dec10f4-leader-finder-thread] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206198910] Added fetcher for partitions ArrayBuffer([[legend-test-topic,0], initOffset 16 to broker id:0,host:10.3.2.20,port:9092] )
2017-10-17 10:09:59.715 [ConsumerFetcherThread-legend-app-group_sondon-1508206198754-1dec10f4-0-0] INFO  kafka.consumer.ConsumerFetcherThread -[ConsumerFetcherThread-legend-app-group_sondon-1508206198754-1dec10f4-0-0], Starting 
2017-10-17 10:09:59.815 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[10.3.2.23:27017, 10.3.2.24:27017, 10.3.2.25:27017], mode=MULTIPLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=40000}
2017-10-17 10:09:59.816 [main] INFO  org.mongodb.driver.cluster -Adding discovered server 10.3.2.23:27017 to client view of cluster
2017-10-17 10:09:59.830 [main] INFO  org.mongodb.driver.cluster -Adding discovered server 10.3.2.24:27017 to client view of cluster
2017-10-17 10:09:59.834 [main] INFO  org.mongodb.driver.cluster -Adding discovered server 10.3.2.25:27017 to client view of cluster
2017-10-17 10:09:59.913 [cluster-ClusterId{value='59e566779d8dab2137bae1b6', description='null'}-10.3.2.25:27017] INFO  org.mongodb.driver.cluster -Monitor thread successfully connected to server with description ServerDescription{address=10.3.2.25:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, version=ServerVersion{versionList=[3, 2, 9]}, minWireVersion=0, maxWireVersion=4, maxDocumentSize=16777216, roundTripTimeNanos=966645, setName='sondon', canonicalAddress=10.3.2.25:27017, hosts=[10.3.2.23:27017, 10.3.2.25:27017, 10.3.2.24:27017], passives=[], arbiters=[], primary='10.3.2.23:27017', tagSet=TagSet{[]}, electionId=null, setVersion=1}
2017-10-17 10:09:59.914 [cluster-ClusterId{value='59e566779d8dab2137bae1b6', description='null'}-10.3.2.24:27017] INFO  org.mongodb.driver.cluster -Monitor thread successfully connected to server with description ServerDescription{address=10.3.2.24:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, version=ServerVersion{versionList=[3, 2, 9]}, minWireVersion=0, maxWireVersion=4, maxDocumentSize=16777216, roundTripTimeNanos=1473430, setName='sondon', canonicalAddress=10.3.2.24:27017, hosts=[10.3.2.23:27017, 10.3.2.25:27017, 10.3.2.24:27017], passives=[], arbiters=[], primary='10.3.2.23:27017', tagSet=TagSet{[]}, electionId=null, setVersion=1}
2017-10-17 10:09:59.921 [cluster-ClusterId{value='59e566779d8dab2137bae1b6', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Monitor thread successfully connected to server with description ServerDescription{address=10.3.2.23:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, version=ServerVersion{versionList=[3, 2, 9]}, minWireVersion=0, maxWireVersion=4, maxDocumentSize=16777216, roundTripTimeNanos=1116136, setName='sondon', canonicalAddress=10.3.2.23:27017, hosts=[10.3.2.23:27017, 10.3.2.25:27017, 10.3.2.24:27017], passives=[], arbiters=[], primary='10.3.2.23:27017', tagSet=TagSet{[]}, electionId=7fffffff0000000000000015, setVersion=1}
2017-10-17 10:09:59.921 [cluster-ClusterId{value='59e566779d8dab2137bae1b6', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Discovered cluster type of REPLICA_SET
2017-10-17 10:09:59.922 [cluster-ClusterId{value='59e566779d8dab2137bae1b6', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Setting max election id to 7fffffff0000000000000015 from replica set primary 10.3.2.23:27017
2017-10-17 10:09:59.922 [cluster-ClusterId{value='59e566779d8dab2137bae1b6', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Setting max set version to 1 from replica set primary 10.3.2.23:27017
2017-10-17 10:09:59.923 [cluster-ClusterId{value='59e566779d8dab2137bae1b6', description='null'}-10.3.2.23:27017] INFO  org.mongodb.driver.cluster -Discovered replica set primary 10.3.2.23:27017
2017-10-17 10:10:00.173 [main] INFO  ROOT -Application start failed!
2017-10-17 10:11:59.410 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Neither @ContextConfiguration nor @ContextHierarchy found for test class [AppTest], using SpringBootContextLoader
2017-10-17 10:11:59.424 [main] INFO  o.s.t.c.s.AbstractContextLoader -Could not detect default resource locations for test class [AppTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2017-10-17 10:11:59.711 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@35dab4eb, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@2d901eb0, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@3ba987b8, org.springframework.test.context.support.DirtiesContextTestExecutionListener@3f191845]
2017-10-17 10:12:01.378 [main] INFO  AppTest -Starting AppTest on sondon with PID 8687 (started by sondon in /home/sondon/IdeaProjects/dplus-service/legend-app)
2017-10-17 10:12:01.379 [main] INFO  AppTest -The following profiles are active: local
2017-10-17 10:12:03.292 [main] WARN  o.m.s.mapper.ClassPathMapperScanner -No MyBatis mapper was found in '[cn.com.dplus.legend.application]' package. Please check your configuration.
2017-10-17 10:12:03.336 [main] INFO  o.s.b.f.s.DefaultListableBeanFactory -Overriding bean definition for bean 'characterEncodingFilter' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=webConfig; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cn/com/dplus/project/config/WebConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/web/HttpEncodingAutoConfiguration.class]]
2017-10-17 10:12:09.479 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
2017-10-17 10:12:09.570 [cluster-ClusterId{value='59e566f99d8dab21ef44ffb6', description='null'}-localhost:27017] INFO  org.mongodb.driver.cluster -Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63)
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115)
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:116)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50)
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58)
	... 3 common frames omitted
2017-10-17 10:12:11.041 [main] INFO  r.clients.jedis.JedisSentinelPool -Trying to find master from available Sentinels...
2017-10-17 10:12:11.072 [main] INFO  r.clients.jedis.JedisSentinelPool -Redis master running at 10.3.2.23:6379, starting Sentinel listeners...
2017-10-17 10:12:11.102 [main] INFO  r.clients.jedis.JedisSentinelPool -Created JedisPool to master at 10.3.2.23:6379
2017-10-17 10:12:11.110 [main] INFO  ROOT -
env--->ZK_LIST
target --->10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:12:11.309 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:12:11.349 [main] INFO  kafka.utils.VerifiableProperties -Property auto.commit.interval.ms is overridden to 1000
2017-10-17 10:12:11.354 [main] INFO  kafka.utils.VerifiableProperties -Property auto.offset.reset is overridden to smallest
2017-10-17 10:12:11.354 [main] INFO  kafka.utils.VerifiableProperties -Property group.id is overridden to legend-app-group
2017-10-17 10:12:11.355 [main] WARN  kafka.utils.VerifiableProperties -Property serializer.class is not valid
2017-10-17 10:12:11.355 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.connect is overridden to 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:12:11.355 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.session.timeout.ms is overridden to 15000
2017-10-17 10:12:11.356 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.sync.time.ms is overridden to 200
2017-10-17 10:12:11.421 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], Connecting to zookeeper instance at 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:12:11.438 [ZkClient-EventThread-27-10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181] INFO  org.I0Itec.zkclient.ZkEventThread -Starting ZkClient event thread.
2017-10-17 10:12:11.467 [main-SendThread(10.3.2.20:2181)] INFO  org.apache.zookeeper.ClientCnxn -Opening socket connection to server 10.3.2.20/10.3.2.20:2181. Will not attempt to authenticate using SASL (unknown error)
2017-10-17 10:12:11.479 [main-SendThread(10.3.2.20:2181)] INFO  org.apache.zookeeper.ClientCnxn -Socket connection established to 10.3.2.20/10.3.2.20:2181, initiating session
2017-10-17 10:12:11.535 [main-SendThread(10.3.2.20:2181)] INFO  org.apache.zookeeper.ClientCnxn -Session establishment complete on server 10.3.2.20/10.3.2.20:2181, sessionid = 0x15f1ab9e1b3000c, negotiated timeout = 15000
2017-10-17 10:12:11.539 [main-EventThread] INFO  org.I0Itec.zkclient.ZkClient -zookeeper state changed (SyncConnected)
2017-10-17 10:12:11.554 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], starting auto committer every 1000 ms
2017-10-17 10:12:11.618 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], begin registering consumer legend-app-group_sondon-1508206331419-267d8336 in ZK
2017-10-17 10:12:11.677 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], end registering consumer legend-app-group_sondon-1508206331419-267d8336 in ZK
2017-10-17 10:12:11.693 [legend-app-group_sondon-1508206331419-267d8336_watcher_executor] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], starting watcher executor thread for consumer legend-app-group_sondon-1508206331419-267d8336
2017-10-17 10:12:11.737 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], begin rebalancing consumer legend-app-group_sondon-1508206331419-267d8336 try #0
2017-10-17 10:12:12.008 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206331545] Stopping leader finder thread
2017-10-17 10:12:12.011 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206331545] Stopping all fetchers
2017-10-17 10:12:12.014 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206331545] All connections stopped
2017-10-17 10:12:12.016 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], Cleared all relevant queues for this fetcher
2017-10-17 10:12:12.019 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], Cleared the data chunks in all the consumer message iterators
2017-10-17 10:12:12.022 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], Committing all offsets after clearing the fetcher queues
2017-10-17 10:12:12.025 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], Releasing partition ownership
2017-10-17 10:12:12.118 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], legend-app-group_sondon-1508206331419-267d8336-0 successfully owned partition 0 for topic legend-test-topic
2017-10-17 10:12:12.144 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], Consumer legend-app-group_sondon-1508206331419-267d8336 selected partitions : legend-test-topic:0: fetched offset = 16: consumed offset = 16
2017-10-17 10:12:12.147 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206331419-267d8336], end rebalancing consumer legend-app-group_sondon-1508206331419-267d8336 try #0
2017-10-17 10:12:12.153 [main] INFO  ROOT -
env--->KAFKA_LIST
target --->10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:12:12.156 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  k.c.ConsumerFetcherManager$LeaderFinderThread -[legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread], Starting 
2017-10-17 10:12:12.169 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:12:12.170 [main] INFO  kafka.utils.VerifiableProperties -Property key.serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:12:12.170 [main] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:12:12.170 [main] INFO  kafka.utils.VerifiableProperties -Property request.required.acks is overridden to -1
2017-10-17 10:12:12.170 [main] INFO  kafka.utils.VerifiableProperties -Property serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:12:12.189 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:12:12.190 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property client.id is overridden to legend-app-group
2017-10-17 10:12:12.190 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:12:12.190 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property request.timeout.ms is overridden to 30000
2017-10-17 10:12:12.208 [main] INFO  ROOT -Application start success!
2017-10-17 10:12:12.270 [main] INFO  AppTest -Started AppTest in 12.137 seconds (JVM running for 14.769)
2017-10-17 10:12:12.283 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  kafka.client.ClientUtils$ -Fetching metadata from broker id:0,host:10.3.2.20,port:9092 with correlation id 0 for 1 topic(s) Set(legend-test-topic)
2017-10-17 10:12:12.289 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  kafka.producer.SyncProducer -Connected to 10.3.2.20:9092 for producing
2017-10-17 10:12:12.337 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  kafka.producer.SyncProducer -Disconnecting from 10.3.2.20:9092
2017-10-17 10:12:12.976 [ConsumerFetcherThread-legend-app-group_sondon-1508206331419-267d8336-0-0] INFO  kafka.consumer.ConsumerFetcherThread -[ConsumerFetcherThread-legend-app-group_sondon-1508206331419-267d8336-0-0], Starting 
2017-10-17 10:12:13.018 [legend-app-group_sondon-1508206331419-267d8336-leader-finder-thread] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206331545] Added fetcher for partitions ArrayBuffer([[legend-test-topic,0], initOffset 16 to broker id:0,host:10.3.2.20,port:9092] )
2017-10-17 10:12:53.218 [main-SendThread(10.3.2.20:2181)] INFO  org.apache.zookeeper.ClientCnxn -Client session timed out, have not heard from server in 13227ms for sessionid 0x15f1ab9e1b3000c, closing socket connection and attempting reconnect
2017-10-17 10:21:55.951 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Neither @ContextConfiguration nor @ContextHierarchy found for test class [AppTest], using SpringBootContextLoader
2017-10-17 10:21:55.964 [main] INFO  o.s.t.c.s.AbstractContextLoader -Could not detect default resource locations for test class [AppTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2017-10-17 10:21:56.228 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@353352b6, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@4681c175, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@57a78e3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@402c4085]
2017-10-17 10:21:57.961 [main] INFO  AppTest -Starting AppTest on sondon with PID 9207 (started by sondon in /home/sondon/IdeaProjects/dplus-service/legend-app)
2017-10-17 10:21:57.963 [main] INFO  AppTest -The following profiles are active: local
2017-10-17 10:21:59.880 [main] WARN  o.m.s.mapper.ClassPathMapperScanner -No MyBatis mapper was found in '[cn.com.dplus.legend.application]' package. Please check your configuration.
2017-10-17 10:21:59.954 [main] INFO  o.s.b.f.s.DefaultListableBeanFactory -Overriding bean definition for bean 'characterEncodingFilter' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=webConfig; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cn/com/dplus/project/config/WebConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/web/HttpEncodingAutoConfiguration.class]]
2017-10-17 10:22:05.635 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
2017-10-17 10:22:05.734 [cluster-ClusterId{value='59e5694d9d8dab23f70cdfab', description='null'}-localhost:27017] INFO  org.mongodb.driver.cluster -Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63)
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115)
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:116)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50)
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58)
	... 3 common frames omitted
2017-10-17 10:22:07.134 [main] INFO  r.clients.jedis.JedisSentinelPool -Trying to find master from available Sentinels...
2017-10-17 10:22:07.166 [main] INFO  r.clients.jedis.JedisSentinelPool -Redis master running at 10.3.2.23:6379, starting Sentinel listeners...
2017-10-17 10:22:07.200 [main] INFO  r.clients.jedis.JedisSentinelPool -Created JedisPool to master at 10.3.2.23:6379
2017-10-17 10:22:07.208 [main] INFO  ROOT -
env--->ZK_LIST
target --->10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:22:07.454 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:22:07.489 [main] INFO  kafka.utils.VerifiableProperties -Property auto.commit.interval.ms is overridden to 1000
2017-10-17 10:22:07.490 [main] INFO  kafka.utils.VerifiableProperties -Property auto.offset.reset is overridden to smallest
2017-10-17 10:22:07.491 [main] INFO  kafka.utils.VerifiableProperties -Property group.id is overridden to legend-app-group
2017-10-17 10:22:07.493 [main] WARN  kafka.utils.VerifiableProperties -Property serializer.class is not valid
2017-10-17 10:22:07.494 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.connect is overridden to 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:22:07.495 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.session.timeout.ms is overridden to 15000
2017-10-17 10:22:07.495 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.sync.time.ms is overridden to 200
2017-10-17 10:22:07.568 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], Connecting to zookeeper instance at 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:22:07.589 [ZkClient-EventThread-27-10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181] INFO  org.I0Itec.zkclient.ZkEventThread -Starting ZkClient event thread.
2017-10-17 10:22:07.626 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Opening socket connection to server 10.3.2.21/10.3.2.21:2181. Will not attempt to authenticate using SASL (unknown error)
2017-10-17 10:22:07.637 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Socket connection established to 10.3.2.21/10.3.2.21:2181, initiating session
2017-10-17 10:22:07.669 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Session establishment complete on server 10.3.2.21/10.3.2.21:2181, sessionid = 0x25f235886b50007, negotiated timeout = 15000
2017-10-17 10:22:07.673 [main-EventThread] INFO  org.I0Itec.zkclient.ZkClient -zookeeper state changed (SyncConnected)
2017-10-17 10:22:07.691 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], starting auto committer every 1000 ms
2017-10-17 10:22:07.780 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], begin registering consumer legend-app-group_sondon-1508206927565-7bb7d84f in ZK
2017-10-17 10:22:07.843 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], end registering consumer legend-app-group_sondon-1508206927565-7bb7d84f in ZK
2017-10-17 10:22:07.861 [legend-app-group_sondon-1508206927565-7bb7d84f_watcher_executor] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], starting watcher executor thread for consumer legend-app-group_sondon-1508206927565-7bb7d84f
2017-10-17 10:22:07.908 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], begin rebalancing consumer legend-app-group_sondon-1508206927565-7bb7d84f try #0
2017-10-17 10:22:08.153 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206927683] Stopping leader finder thread
2017-10-17 10:22:08.154 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206927683] Stopping all fetchers
2017-10-17 10:22:08.156 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206927683] All connections stopped
2017-10-17 10:22:08.157 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], Cleared all relevant queues for this fetcher
2017-10-17 10:22:08.160 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], Cleared the data chunks in all the consumer message iterators
2017-10-17 10:22:08.163 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], Committing all offsets after clearing the fetcher queues
2017-10-17 10:22:08.166 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], Releasing partition ownership
2017-10-17 10:22:08.262 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], legend-app-group_sondon-1508206927565-7bb7d84f-0 successfully owned partition 0 for topic legend-test-topic
2017-10-17 10:22:08.293 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], Consumer legend-app-group_sondon-1508206927565-7bb7d84f selected partitions : legend-test-topic:0: fetched offset = 16: consumed offset = 16
2017-10-17 10:22:08.297 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508206927565-7bb7d84f], end rebalancing consumer legend-app-group_sondon-1508206927565-7bb7d84f try #0
2017-10-17 10:22:08.305 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  k.c.ConsumerFetcherManager$LeaderFinderThread -[legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread], Starting 
2017-10-17 10:22:08.309 [main] INFO  ROOT -
env--->KAFKA_LIST
target --->10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:22:08.331 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:22:08.334 [main] INFO  kafka.utils.VerifiableProperties -Property key.serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:22:08.334 [main] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:22:08.334 [main] INFO  kafka.utils.VerifiableProperties -Property request.required.acks is overridden to -1
2017-10-17 10:22:08.334 [main] INFO  kafka.utils.VerifiableProperties -Property serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:22:08.379 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:22:08.383 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property client.id is overridden to legend-app-group
2017-10-17 10:22:08.383 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:22:08.386 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property request.timeout.ms is overridden to 30000
2017-10-17 10:22:08.404 [main] INFO  ROOT -Application start success!
2017-10-17 10:22:08.427 [main] INFO  AppTest -Started AppTest in 11.95 seconds (JVM running for 14.209)
2017-10-17 10:22:08.472 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  kafka.client.ClientUtils$ -Fetching metadata from broker id:0,host:10.3.2.20,port:9092 with correlation id 0 for 1 topic(s) Set(legend-test-topic)
2017-10-17 10:22:08.479 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  kafka.producer.SyncProducer -Connected to 10.3.2.20:9092 for producing
2017-10-17 10:22:09.906 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  kafka.producer.SyncProducer -Disconnecting from 10.3.2.20:9092
2017-10-17 10:22:10.107 [ConsumerFetcherThread-legend-app-group_sondon-1508206927565-7bb7d84f-0-0] INFO  kafka.consumer.ConsumerFetcherThread -[ConsumerFetcherThread-legend-app-group_sondon-1508206927565-7bb7d84f-0-0], Starting 
2017-10-17 10:22:10.112 [legend-app-group_sondon-1508206927565-7bb7d84f-leader-finder-thread] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508206927683] Added fetcher for partitions ArrayBuffer([[legend-test-topic,0], initOffset 16 to broker id:0,host:10.3.2.20,port:9092] )
2017-10-17 10:30:35.462 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Neither @ContextConfiguration nor @ContextHierarchy found for test class [AppTest], using SpringBootContextLoader
2017-10-17 10:30:35.505 [main] INFO  o.s.t.c.s.AbstractContextLoader -Could not detect default resource locations for test class [AppTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2017-10-17 10:30:35.713 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@353352b6, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@4681c175, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@57a78e3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@402c4085]
2017-10-17 10:30:37.239 [main] INFO  AppTest -Starting AppTest on sondon with PID 9531 (started by sondon in /home/sondon/IdeaProjects/dplus-service/legend-app)
2017-10-17 10:30:37.244 [main] INFO  AppTest -The following profiles are active: local
2017-10-17 10:30:40.229 [main] WARN  o.m.s.mapper.ClassPathMapperScanner -No MyBatis mapper was found in '[cn.com.dplus.legend.application]' package. Please check your configuration.
2017-10-17 10:30:40.396 [main] INFO  o.s.b.f.s.DefaultListableBeanFactory -Overriding bean definition for bean 'characterEncodingFilter' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=webConfig; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cn/com/dplus/project/config/WebConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/web/HttpEncodingAutoConfiguration.class]]
2017-10-17 10:30:46.973 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
2017-10-17 10:30:47.067 [cluster-ClusterId{value='59e56b569d8dab253b68b03e', description='null'}-localhost:27017] INFO  org.mongodb.driver.cluster -Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63)
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115)
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:116)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50)
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58)
	... 3 common frames omitted
2017-10-17 10:30:48.349 [main] INFO  r.clients.jedis.JedisSentinelPool -Trying to find master from available Sentinels...
2017-10-17 10:30:48.395 [main] INFO  r.clients.jedis.JedisSentinelPool -Redis master running at 10.3.2.23:6379, starting Sentinel listeners...
2017-10-17 10:30:48.432 [main] INFO  r.clients.jedis.JedisSentinelPool -Created JedisPool to master at 10.3.2.23:6379
2017-10-17 10:30:48.438 [main] INFO  ROOT -
env--->ZK_LIST
target --->10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:30:48.640 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:30:48.683 [main] INFO  kafka.utils.VerifiableProperties -Property auto.commit.interval.ms is overridden to 1000
2017-10-17 10:30:48.685 [main] INFO  kafka.utils.VerifiableProperties -Property auto.offset.reset is overridden to smallest
2017-10-17 10:30:48.686 [main] INFO  kafka.utils.VerifiableProperties -Property group.id is overridden to legend-app-group
2017-10-17 10:30:48.687 [main] WARN  kafka.utils.VerifiableProperties -Property serializer.class is not valid
2017-10-17 10:30:48.688 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.connect is overridden to 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:30:48.689 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.session.timeout.ms is overridden to 15000
2017-10-17 10:30:48.690 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.sync.time.ms is overridden to 200
2017-10-17 10:30:48.763 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], Connecting to zookeeper instance at 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:30:48.782 [ZkClient-EventThread-27-10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181] INFO  org.I0Itec.zkclient.ZkEventThread -Starting ZkClient event thread.
2017-10-17 10:30:48.821 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Opening socket connection to server 10.3.2.21/10.3.2.21:2181. Will not attempt to authenticate using SASL (unknown error)
2017-10-17 10:30:48.831 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Socket connection established to 10.3.2.21/10.3.2.21:2181, initiating session
2017-10-17 10:30:48.860 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Session establishment complete on server 10.3.2.21/10.3.2.21:2181, sessionid = 0x25f235886b50008, negotiated timeout = 15000
2017-10-17 10:30:48.862 [main-EventThread] INFO  org.I0Itec.zkclient.ZkClient -zookeeper state changed (SyncConnected)
2017-10-17 10:30:48.872 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], starting auto committer every 1000 ms
2017-10-17 10:30:48.921 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], begin registering consumer legend-app-group_sondon-1508207448761-9bd6d5a1 in ZK
2017-10-17 10:30:48.992 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], end registering consumer legend-app-group_sondon-1508207448761-9bd6d5a1 in ZK
2017-10-17 10:30:49.021 [legend-app-group_sondon-1508207448761-9bd6d5a1_watcher_executor] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], starting watcher executor thread for consumer legend-app-group_sondon-1508207448761-9bd6d5a1
2017-10-17 10:30:49.059 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], begin rebalancing consumer legend-app-group_sondon-1508207448761-9bd6d5a1 try #0
2017-10-17 10:30:49.309 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207448868] Stopping leader finder thread
2017-10-17 10:30:49.310 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207448868] Stopping all fetchers
2017-10-17 10:30:49.312 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207448868] All connections stopped
2017-10-17 10:30:49.313 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], Cleared all relevant queues for this fetcher
2017-10-17 10:30:49.315 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], Cleared the data chunks in all the consumer message iterators
2017-10-17 10:30:49.315 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], Committing all offsets after clearing the fetcher queues
2017-10-17 10:30:49.317 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], Releasing partition ownership
2017-10-17 10:30:49.394 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], legend-app-group_sondon-1508207448761-9bd6d5a1-0 successfully owned partition 0 for topic legend-test-topic
2017-10-17 10:30:49.420 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], Consumer legend-app-group_sondon-1508207448761-9bd6d5a1 selected partitions : legend-test-topic:0: fetched offset = 16: consumed offset = 16
2017-10-17 10:30:49.423 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207448761-9bd6d5a1], end rebalancing consumer legend-app-group_sondon-1508207448761-9bd6d5a1 try #0
2017-10-17 10:30:49.433 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  k.c.ConsumerFetcherManager$LeaderFinderThread -[legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread], Starting 
2017-10-17 10:30:49.437 [main] INFO  ROOT -
env--->KAFKA_LIST
target --->10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:30:49.455 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:30:49.455 [main] INFO  kafka.utils.VerifiableProperties -Property key.serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:30:49.457 [main] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:30:49.457 [main] INFO  kafka.utils.VerifiableProperties -Property request.required.acks is overridden to -1
2017-10-17 10:30:49.457 [main] INFO  kafka.utils.VerifiableProperties -Property serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:30:49.487 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:30:49.487 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property client.id is overridden to legend-app-group
2017-10-17 10:30:49.487 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:30:49.489 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property request.timeout.ms is overridden to 30000
2017-10-17 10:30:49.496 [main] INFO  ROOT -Application start success!
2017-10-17 10:30:49.516 [main] INFO  AppTest -Started AppTest in 13.535 seconds (JVM running for 15.684)
2017-10-17 10:30:49.538 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  kafka.client.ClientUtils$ -Fetching metadata from broker id:2,host:10.3.2.22,port:9092 with correlation id 0 for 1 topic(s) Set(legend-test-topic)
2017-10-17 10:30:49.546 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  kafka.producer.SyncProducer -Connected to 10.3.2.22:9092 for producing
2017-10-17 10:30:49.625 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  kafka.producer.SyncProducer -Disconnecting from 10.3.2.22:9092
2017-10-17 10:30:49.662 [legend-app-group_sondon-1508207448761-9bd6d5a1-leader-finder-thread] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207448868] Added fetcher for partitions ArrayBuffer([[legend-test-topic,0], initOffset 16 to broker id:0,host:10.3.2.20,port:9092] )
2017-10-17 10:30:49.664 [ConsumerFetcherThread-legend-app-group_sondon-1508207448761-9bd6d5a1-0-0] INFO  kafka.consumer.ConsumerFetcherThread -[ConsumerFetcherThread-legend-app-group_sondon-1508207448761-9bd6d5a1-0-0], Starting 
2017-10-17 10:32:53.830 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Neither @ContextConfiguration nor @ContextHierarchy found for test class [AppTest], using SpringBootContextLoader
2017-10-17 10:32:53.854 [main] INFO  o.s.t.c.s.AbstractContextLoader -Could not detect default resource locations for test class [AppTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2017-10-17 10:32:54.111 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@353352b6, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@4681c175, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@57a78e3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@402c4085]
2017-10-17 10:32:55.693 [main] INFO  AppTest -Starting AppTest on sondon with PID 9688 (started by sondon in /home/sondon/IdeaProjects/dplus-service/legend-app)
2017-10-17 10:32:55.695 [main] INFO  AppTest -The following profiles are active: local
2017-10-17 10:32:57.614 [main] WARN  o.m.s.mapper.ClassPathMapperScanner -No MyBatis mapper was found in '[cn.com.dplus.legend.application]' package. Please check your configuration.
2017-10-17 10:32:57.661 [main] INFO  o.s.b.f.s.DefaultListableBeanFactory -Overriding bean definition for bean 'characterEncodingFilter' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=webConfig; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cn/com/dplus/project/config/WebConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/web/HttpEncodingAutoConfiguration.class]]
2017-10-17 10:33:03.635 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
2017-10-17 10:33:03.720 [cluster-ClusterId{value='59e56bdf9d8dab25d872cfbb', description='null'}-localhost:27017] INFO  org.mongodb.driver.cluster -Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63)
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115)
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:116)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50)
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58)
	... 3 common frames omitted
2017-10-17 10:33:05.156 [main] INFO  r.clients.jedis.JedisSentinelPool -Trying to find master from available Sentinels...
2017-10-17 10:33:05.189 [main] INFO  r.clients.jedis.JedisSentinelPool -Redis master running at 10.3.2.23:6379, starting Sentinel listeners...
2017-10-17 10:33:05.228 [main] INFO  r.clients.jedis.JedisSentinelPool -Created JedisPool to master at 10.3.2.23:6379
2017-10-17 10:33:05.232 [main] INFO  ROOT -
env--->ZK_LIST
target --->10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:33:05.463 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:33:05.501 [main] INFO  kafka.utils.VerifiableProperties -Property auto.commit.interval.ms is overridden to 1000
2017-10-17 10:33:05.502 [main] INFO  kafka.utils.VerifiableProperties -Property auto.offset.reset is overridden to smallest
2017-10-17 10:33:05.502 [main] INFO  kafka.utils.VerifiableProperties -Property group.id is overridden to legend-app-group
2017-10-17 10:33:05.503 [main] WARN  kafka.utils.VerifiableProperties -Property serializer.class is not valid
2017-10-17 10:33:05.503 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.connect is overridden to 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:33:05.503 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.session.timeout.ms is overridden to 15000
2017-10-17 10:33:05.504 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.sync.time.ms is overridden to 200
2017-10-17 10:33:05.569 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], Connecting to zookeeper instance at 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 10:33:05.585 [ZkClient-EventThread-27-10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181] INFO  org.I0Itec.zkclient.ZkEventThread -Starting ZkClient event thread.
2017-10-17 10:33:05.621 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Opening socket connection to server 10.3.2.21/10.3.2.21:2181. Will not attempt to authenticate using SASL (unknown error)
2017-10-17 10:33:05.630 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Socket connection established to 10.3.2.21/10.3.2.21:2181, initiating session
2017-10-17 10:33:05.677 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Session establishment complete on server 10.3.2.21/10.3.2.21:2181, sessionid = 0x25f235886b50009, negotiated timeout = 15000
2017-10-17 10:33:05.680 [main-EventThread] INFO  org.I0Itec.zkclient.ZkClient -zookeeper state changed (SyncConnected)
2017-10-17 10:33:05.716 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], starting auto committer every 1000 ms
2017-10-17 10:33:05.803 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], begin registering consumer legend-app-group_sondon-1508207585567-d1398b0b in ZK
2017-10-17 10:33:05.859 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], end registering consumer legend-app-group_sondon-1508207585567-d1398b0b in ZK
2017-10-17 10:33:05.873 [legend-app-group_sondon-1508207585567-d1398b0b_watcher_executor] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], starting watcher executor thread for consumer legend-app-group_sondon-1508207585567-d1398b0b
2017-10-17 10:33:05.902 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], begin rebalancing consumer legend-app-group_sondon-1508207585567-d1398b0b try #0
2017-10-17 10:33:06.157 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207585686] Stopping leader finder thread
2017-10-17 10:33:06.158 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207585686] Stopping all fetchers
2017-10-17 10:33:06.161 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207585686] All connections stopped
2017-10-17 10:33:06.162 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], Cleared all relevant queues for this fetcher
2017-10-17 10:33:06.164 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], Cleared the data chunks in all the consumer message iterators
2017-10-17 10:33:06.164 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], Committing all offsets after clearing the fetcher queues
2017-10-17 10:33:06.166 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], Releasing partition ownership
2017-10-17 10:33:06.251 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], legend-app-group_sondon-1508207585567-d1398b0b-0 successfully owned partition 0 for topic legend-test-topic
2017-10-17 10:33:06.273 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], Consumer legend-app-group_sondon-1508207585567-d1398b0b selected partitions : legend-test-topic:0: fetched offset = 16: consumed offset = 16
2017-10-17 10:33:06.276 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  k.c.ConsumerFetcherManager$LeaderFinderThread -[legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread], Starting 
2017-10-17 10:33:06.277 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508207585567-d1398b0b], end rebalancing consumer legend-app-group_sondon-1508207585567-d1398b0b try #0
2017-10-17 10:33:06.285 [main] INFO  ROOT -
env--->KAFKA_LIST
target --->10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:33:06.304 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:33:06.305 [main] INFO  kafka.utils.VerifiableProperties -Property key.serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:33:06.305 [main] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:33:06.305 [main] INFO  kafka.utils.VerifiableProperties -Property request.required.acks is overridden to -1
2017-10-17 10:33:06.305 [main] INFO  kafka.utils.VerifiableProperties -Property serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 10:33:06.316 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 10:33:06.316 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property client.id is overridden to legend-app-group
2017-10-17 10:33:06.316 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 10:33:06.317 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property request.timeout.ms is overridden to 30000
2017-10-17 10:33:06.336 [main] INFO  ROOT -Application start success!
2017-10-17 10:33:06.353 [main] INFO  AppTest -Started AppTest in 11.969 seconds (JVM running for 14.036)
2017-10-17 10:33:06.376 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  kafka.client.ClientUtils$ -Fetching metadata from broker id:1,host:10.3.2.21,port:9092 with correlation id 0 for 1 topic(s) Set(legend-test-topic)
2017-10-17 10:33:06.392 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  kafka.producer.SyncProducer -Connected to 10.3.2.21:9092 for producing
2017-10-17 10:33:06.493 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  kafka.producer.SyncProducer -Disconnecting from 10.3.2.21:9092
2017-10-17 10:33:06.531 [ConsumerFetcherThread-legend-app-group_sondon-1508207585567-d1398b0b-0-0] INFO  kafka.consumer.ConsumerFetcherThread -[ConsumerFetcherThread-legend-app-group_sondon-1508207585567-d1398b0b-0-0], Starting 
2017-10-17 10:33:06.533 [legend-app-group_sondon-1508207585567-d1398b0b-leader-finder-thread] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508207585686] Added fetcher for partitions ArrayBuffer([[legend-test-topic,0], initOffset 16 to broker id:0,host:10.3.2.20,port:9092] )
2017-10-17 11:34:26.135 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Neither @ContextConfiguration nor @ContextHierarchy found for test class [AppTest], using SpringBootContextLoader
2017-10-17 11:34:26.209 [main] INFO  o.s.t.c.s.AbstractContextLoader -Could not detect default resource locations for test class [AppTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2017-10-17 11:34:26.445 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@353352b6, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@4681c175, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@57a78e3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@402c4085]
2017-10-17 11:34:29.089 [main] INFO  AppTest -Starting AppTest on sondon with PID 11060 (started by sondon in /home/sondon/IdeaProjects/dplus-service/legend-app)
2017-10-17 11:34:29.089 [main] INFO  AppTest -The following profiles are active: local
2017-10-17 11:34:33.935 [main] WARN  o.m.s.mapper.ClassPathMapperScanner -No MyBatis mapper was found in '[cn.com.dplus.legend.application]' package. Please check your configuration.
2017-10-17 11:34:34.017 [main] INFO  o.s.b.f.s.DefaultListableBeanFactory -Overriding bean definition for bean 'characterEncodingFilter' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=webConfig; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cn/com/dplus/project/config/WebConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration; factoryMethodName=characterEncodingFilter; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/web/HttpEncodingAutoConfiguration.class]]
2017-10-17 11:34:40.566 [main] INFO  org.mongodb.driver.cluster -Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
2017-10-17 11:34:40.626 [cluster-ClusterId{value='59e57a509d8dab2b34da2709', description='null'}-localhost:27017] INFO  org.mongodb.driver.cluster -Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.connection.SocketStream.open(SocketStream.java:63)
	at com.mongodb.connection.InternalStreamConnection.open(InternalStreamConnection.java:115)
	at com.mongodb.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:116)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mongodb.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:50)
	at com.mongodb.connection.SocketStream.open(SocketStream.java:58)
	... 3 common frames omitted
2017-10-17 11:34:41.880 [main] INFO  r.clients.jedis.JedisSentinelPool -Trying to find master from available Sentinels...
2017-10-17 11:34:41.939 [main] INFO  r.clients.jedis.JedisSentinelPool -Redis master running at 10.3.2.23:6379, starting Sentinel listeners...
2017-10-17 11:34:41.990 [main] INFO  r.clients.jedis.JedisSentinelPool -Created JedisPool to master at 10.3.2.23:6379
2017-10-17 11:34:42.000 [main] INFO  ROOT -
env--->ZK_LIST
target --->10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 11:34:42.389 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 11:34:42.426 [main] INFO  kafka.utils.VerifiableProperties -Property auto.commit.interval.ms is overridden to 1000
2017-10-17 11:34:42.427 [main] INFO  kafka.utils.VerifiableProperties -Property auto.offset.reset is overridden to smallest
2017-10-17 11:34:42.427 [main] INFO  kafka.utils.VerifiableProperties -Property group.id is overridden to legend-app-group
2017-10-17 11:34:42.428 [main] WARN  kafka.utils.VerifiableProperties -Property serializer.class is not valid
2017-10-17 11:34:42.430 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.connect is overridden to 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 11:34:42.431 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.session.timeout.ms is overridden to 15000
2017-10-17 11:34:42.431 [main] INFO  kafka.utils.VerifiableProperties -Property zookeeper.sync.time.ms is overridden to 200
2017-10-17 11:34:42.528 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], Connecting to zookeeper instance at 10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181
2017-10-17 11:34:42.550 [ZkClient-EventThread-27-10.3.2.20:2181,10.3.2.21:2181,10.3.2.22:2181] INFO  org.I0Itec.zkclient.ZkEventThread -Starting ZkClient event thread.
2017-10-17 11:34:42.634 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Opening socket connection to server 10.3.2.21/10.3.2.21:2181. Will not attempt to authenticate using SASL (unknown error)
2017-10-17 11:34:42.642 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Socket connection established to 10.3.2.21/10.3.2.21:2181, initiating session
2017-10-17 11:34:42.655 [main-SendThread(10.3.2.21:2181)] INFO  org.apache.zookeeper.ClientCnxn -Session establishment complete on server 10.3.2.21/10.3.2.21:2181, sessionid = 0x25f235886b5000b, negotiated timeout = 15000
2017-10-17 11:34:42.657 [main-EventThread] INFO  org.I0Itec.zkclient.ZkClient -zookeeper state changed (SyncConnected)
2017-10-17 11:34:42.732 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], starting auto committer every 1000 ms
2017-10-17 11:34:42.953 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], begin registering consumer legend-app-group_sondon-1508211282527-9b13dd56 in ZK
2017-10-17 11:34:43.070 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], end registering consumer legend-app-group_sondon-1508211282527-9b13dd56 in ZK
2017-10-17 11:34:43.084 [legend-app-group_sondon-1508211282527-9b13dd56_watcher_executor] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], starting watcher executor thread for consumer legend-app-group_sondon-1508211282527-9b13dd56
2017-10-17 11:34:43.126 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], begin rebalancing consumer legend-app-group_sondon-1508211282527-9b13dd56 try #0
2017-10-17 11:34:43.378 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508211282672] Stopping leader finder thread
2017-10-17 11:34:43.382 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508211282672] Stopping all fetchers
2017-10-17 11:34:43.384 [main] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508211282672] All connections stopped
2017-10-17 11:34:43.385 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], Cleared all relevant queues for this fetcher
2017-10-17 11:34:43.387 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], Cleared the data chunks in all the consumer message iterators
2017-10-17 11:34:43.390 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], Committing all offsets after clearing the fetcher queues
2017-10-17 11:34:43.394 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], Releasing partition ownership
2017-10-17 11:34:43.490 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], legend-app-group_sondon-1508211282527-9b13dd56-0 successfully owned partition 0 for topic legend-test-topic
2017-10-17 11:34:43.516 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], Consumer legend-app-group_sondon-1508211282527-9b13dd56 selected partitions : legend-test-topic:0: fetched offset = 16: consumed offset = 16
2017-10-17 11:34:43.520 [main] INFO  k.c.ZookeeperConsumerConnector -[legend-app-group_sondon-1508211282527-9b13dd56], end rebalancing consumer legend-app-group_sondon-1508211282527-9b13dd56 try #0
2017-10-17 11:34:43.533 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  k.c.ConsumerFetcherManager$LeaderFinderThread -[legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread], Starting 
2017-10-17 11:34:43.541 [main] INFO  ROOT -
env--->KAFKA_LIST
target --->10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 11:34:43.557 [main] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 11:34:43.557 [main] INFO  kafka.utils.VerifiableProperties -Property key.serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 11:34:43.558 [main] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 11:34:43.558 [main] INFO  kafka.utils.VerifiableProperties -Property request.required.acks is overridden to -1
2017-10-17 11:34:43.558 [main] INFO  kafka.utils.VerifiableProperties -Property serializer.class is overridden to kafka.serializer.StringEncoder
2017-10-17 11:34:43.571 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Verifying properties
2017-10-17 11:34:43.572 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property client.id is overridden to legend-app-group
2017-10-17 11:34:43.572 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property metadata.broker.list is overridden to 10.3.2.20:9092,10.3.2.21:9092,10.3.2.22:9092
2017-10-17 11:34:43.572 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  kafka.utils.VerifiableProperties -Property request.timeout.ms is overridden to 30000
2017-10-17 11:34:43.603 [main] INFO  ROOT -Application start success!
2017-10-17 11:34:43.629 [main] INFO  AppTest -Started AppTest in 16.528 seconds (JVM running for 19.872)
2017-10-17 11:34:43.631 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  kafka.client.ClientUtils$ -Fetching metadata from broker id:2,host:10.3.2.22,port:9092 with correlation id 0 for 1 topic(s) Set(legend-test-topic)
2017-10-17 11:34:43.654 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  kafka.producer.SyncProducer -Connected to 10.3.2.22:9092 for producing
2017-10-17 11:34:43.714 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  kafka.producer.SyncProducer -Disconnecting from 10.3.2.22:9092
2017-10-17 11:34:51.378 [legend-app-group_sondon-1508211282527-9b13dd56-leader-finder-thread] INFO  k.consumer.ConsumerFetcherManager -[ConsumerFetcherManager-1508211282672] Added fetcher for partitions ArrayBuffer([[legend-test-topic,0], initOffset 16 to broker id:0,host:10.3.2.20,port:9092] )
2017-10-17 11:34:51.382 [ConsumerFetcherThread-legend-app-group_sondon-1508211282527-9b13dd56-0-0] INFO  kafka.consumer.ConsumerFetcherThread -[ConsumerFetcherThread-legend-app-group_sondon-1508211282527-9b13dd56-0-0], Starting 
